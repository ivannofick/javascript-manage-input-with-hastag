<html>
  <head>
    Halo
  </head>
  <body>
    <input
      id="changed"
      onkeydown="changedString(this)"
      style="height: 12rem; width: 39rem"
    />

    <script>
      /**
       * cursor position https://stackoverflow.com/questions/54381318/get-index-of-marked-text-in-edittext-android-studio-kotlin
       * get char https://stackoverflow.com/questions/50297288/how-can-i-access-a-char-in-string-in-at-specific-number
       *
       *
       * */
      function changedString(event) {
        var idInput = document.getElementById("changed");
        var valuesData = event.value;
        if (valuesData !== "") {
          if (valuesData.endsWith("#")) {
            idInput.value = idInput.value + "saya ";
            return false;
          } else {
            var cursorPosition = idInput.selectionStart;
            var inputValue = idInput.value;
            if (inputValue.charAt(cursorPosition - 1) === "#") {
              var textBefore = inputValue.substring(0, cursorPosition);
              var textAfter = inputValue.substring(cursorPosition);
              var newText = textBefore + "trondol " +textAfter;
              idInput.addEventListener("keydown", function (event) {
                if (event.key === "#") {
                  console.log("event.key", event.key)
                  // idInput.value = newText
                  console.log(newText);
                  console.log("key", event.key);
                  console.log("textBefore", textBefore);
                  console.log("textAfter", textAfter);
                }
              });
            }
          }
        }
      }
    </script>
  </body>
</html>
